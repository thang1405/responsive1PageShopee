function checkEnter(e){if(13==e.keyCode)return window.open("https://www.google.com/search?q="+encodeURI($(".search_google").val())),!1}function swapsheets(){1==$("#mode").data("alt")?($("#mode").attr("href","/content/css/global.css?"+version).data("alt",0),$(".ion-lightbulb").parent("a").removeClass("active")):($("#mode").attr("href","/content/css/global-night.css?"+version).data("alt",1),$(".ion-lightbulb").parent("a").addClass("active"))}$(function(){$(window).on("load resize",function(){var e=.6*$(window).height(),t=.2*$(window).height()/4;$(".textarea").height(e),$(".container").css({margin:t+"px auto 0"}),$(window).width()<=420?$(".search_google").css({width:"70px"}):$(".search_google").css({width:"200px"})}),$(window).on("load",function(){$(".container").show(),$(".footer-print").show(),$(".history-container").show(),0==caret&&$(".textarea").focus()});var e=(t=$(".textarea")).val().match(/\S+/g);null!=e&&0<e.length?$(".word_count").html(e.length):$(".word_count").html("0"),t.on("change input",function(){var e=$(this).val().match(/\S+/g);null!=e&&0<e.length?$(".word_count").html(e.length):$(".word_count").html("0"),$(".char_count").html($(this).val().length)}),t.on("mouseover",function(){$(".fl-left,.fl-right,.footer-share").stop().fadeTo(250,.7)}),$(".fl-left,.fl-right,.footer-share,.modal").on("mouseover",function(){$(".fl-left,.fl-right,.footer-share,.modal").stop().fadeTo(250,1)});var t=$(".textarea"),o=io.connect("https://live.notepad.pw");o.emit("join_room",url_key),t.on("input",function(){a(function(){var e={name:url_key,text:t.val(),cursor_location:t[0].selectionStart};o.emit("editing",e)},600)}),o.on("update",function(e){t.val(e.text),t[0].selectionStart=e.cursor_location,t[0].selectionEnd=e.cursor_location,t.focus()});var n,a=(n=0,function(e,t){clearTimeout(n),n=setTimeout(e,t)}),s=(i(s=parseInt(sessionStorage.getItem("fontSize"))),s||100);function i(e){var t;$(".textarea").css("fontSize",e+"%"),$(".textarea").css("line-height",e+50+"%"),t=e,sessionStorage.setItem("fontSize",t)}$(".increase").click(function(){i(s+=10)}),$(".decrease").click(function(){i(s-=10)}),$(".resize").click(function(){"1500px"==$(".container").css("max-width")?$(".container").css("max-width","800px"):$(".container").css("max-width","1500px")}),$(".np-share>.share-opener").click(function(){$(".np-share>.share-opener").hasClass("ion-ios-upload-outline")?($(".np-share>.share-opener").removeClass("ion-ios-upload-outline").addClass("ion-chevron-down"),$(".share-content").slideDown()):($(".np-share>.share-opener").removeClass("ion-chevron-down").addClass("ion-ios-upload-outline"),$(".share-content").slideUp())}),$(".notepad_logo").click(function(){$(this).slideUp(200),$(".gsearch").slideDown(200),$(".search_google").focus()}),$(".gsearch i").click(function(){$(".gsearch").slideUp(200),$(".notepad_logo").slideDown(200),$(".search_google").val(""),$(".textarea").focus()})});var app=angular.module("app",["ngCookies"]);app.controller("app.navigation",["$scope","$cookies","$rootScope",function(t,o,n){if(o.getObject("typography")){var e=o.getObject("typography");t.sp_class=e.sp_class,"active"==e.sp_class&&$(".textarea").attr("spellcheck",!0)}else{var a={sp_class:"not-active"},s=new Date;s.setDate(s.getDate()+10),o.putObject("typography",a,{expires:s})}t.$watch("mo_class",function(){"active"==t.mo_class&&($(".textarea").css("font-family","monospace"),n.monospace=1)}),t.sp=function(){"not-active"==t.sp_class?(t.sp_class="active",$(".textarea").attr("spellcheck",!0)):(t.sp_class="not-active",$(".textarea").attr("spellcheck",!1)),t.update_cookie()},t.mo=function(){"not-active"==t.mo_class?(t.mo_class="active",n.monospace=1,$(".textarea").css("font-family","monospace")):(t.mo_class="not-active",n.monospace=0,$(".textarea").css("font-family","Arial, Helvetica, sans-serif")),n.push()},t.update_cookie=function(){a={sp_class:t.sp_class};var e=new Date;e.setDate(e.getDate()+10),o.putObject("typography",a,{expires:e})},t.new_note=function(){window.location.href="/"},t.show_password=function(){1==password_set?(t.password_options=!0,t.change_url=!1,t.edit_password=!1):(t.change_url=!1,t.edit_password=!t.password_options)},t.save_password=function(){var e=$(".input-password").val();3<e.length?(t.edit_password=!1,t.change_url=!1,t.password_options=!0,n.password=e,n.push()):0===$(".invalid_pass").length&&($("div").find('[ng-if="edit_password"]').append('<div class="invalid_pass" style="margin-top:-5px;font-size:10px;color:red"><br><i class="ion-close-circled"></i> Password must be longer than 3 characters.</div>'),setTimeout(function(){$(".invalid_pass").stop().fadeOut(500,function(){$(this).remove()})},3e3))},t.remove_password=function(){$.post("/save/update_pass",{url:url_key}),t.password_options=!1,t.edit_password=!0},t.logout=function(){window.location.href="/logout/"+url_key},t.show_change_url=function(){t.edit_password=!1,t.change_url=!0},t.update_url=function(){var t=$(".input-url").val(),e=url_key;1<t.length&&/^[a-z0-9-]+$/i.test(t)?$.getJSON("/change_url/"+e+"/"+t,function(e){!0===e.success?window.location.href="/"+t:0===$(".invalid_url").length&&($("div").find('[ng-if="change_url"]').append('<div class="invalid_url" style="margin-top:-5px;font-size:10px;color:red"><br><i class="ion-close-circled"></i> Invalid or Taken URL</div>'),setTimeout(function(){$(".invalid_url").stop().fadeOut(500,function(){$(this).remove()})},2e3))}):0===$(".invalid_url").length&&($("div").find('[ng-if="change_url"]').append('<div class="invalid_url" style="margin-top:-5px;font-size:10px;color:red"><br><i class="ion-close-circled"></i> Invalid or Taken URL</div>'),setTimeout(function(){$(".invalid_url").stop().fadeOut(500,function(){$(this).remove()})},2e3))},t.close_modal=function(){t.modal=!1},t.shareURL="https://notepad.pw/share/"+pad_key,t.baseURL="https://notepad.pw/"+url_key,t.baseKey=url_key,t.shareKey=pad_key}]),app.controller("app.push",["$scope","$rootScope",function(o,t){o.jqta=$(".textarea"),1==note_created&&$.ajax({url:"/fetch/"+url_key,cache:!1,success:function(e){o.$apply(function(){o.textarea=e}),setTimeout(function(){o.jqta.blur(),document.querySelector("textarea").selectionStart=caret,document.querySelector("textarea").selectionEnd=caret,o.jqta.focus()},250);var t=o.jqta.val().match(/\S+/g);null!=t&&0<t.length?$(".word_count").html(t.length):$(".word_count").html("0"),$(".char_count").html(o.jqta.val().length)}}),t.push=function(){var e={key:pad_key,pad:o.jqta.val(),pw:t.password?t.password:"",url:url_key,monospace:1==t.monospace?1:0,caret:o.jqta[0].selectionStart};$.post("/save",e).success(function(e){$(".main-logo").stop().fadeTo("fast",.33),setTimeout(function(){$(".main-logo").stop().fadeTo("fast",1)},300),"-1"==e&&alert("Your note is too long, please either create a new note or split your notes.")}).error(function(){alert("your note did not save, please check the website and your internet connection.")})},o.debounce=function(n,a,s){var i;return function(){var e=this,t=arguments,o=s&&!i;clearTimeout(i),i=setTimeout(function(){i=null,s||n.apply(e,t)},a),o&&n.apply(e,t)}},o.update_contents=o.debounce(t.push,500)}]),app.directive("bindInput",function(){return function(t,e,o){e.bind("input",function(e){t.$apply(function(){t.$eval(o.bindInput)}),e.preventDefault()})}}),app.directive("allowTab",function(){return function(e,t,o,n){t.bind("keydown keyup",function(e){var t=this.value;if(9===e.keyCode&&"keydown"===e.type){var o=this.selectionStart,n=this.selectionEnd;return this.value=t.substring(0,o)+"\t"+t.substring(n),this.selectionStart=this.selectionEnd=o+1,e.preventDefault(),!1}})}}),app.directive("openUrl",function(){return function(e,t,o){t.bind("keydown",function(e){if(e.ctrlKey||e.metaKey)switch(String.fromCharCode(e.which).toLowerCase()){case"k":e.preventDefault(),t=o(),/^(https?|ftp):\/\/([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])){3}|([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.(com|edu|gov|int|me|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(\/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$/.test(t)&&window.open(o())}var t;function o(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(e=document.selection.createRange().text),e}})}});